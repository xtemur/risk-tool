<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { background-color: #2c3e50; color: white; padding: 20px; text-align: center; }
        .summary { background-color: #ecf0f1; padding: 15px; margin: 20px 0; border-radius: 5px; }
        .risk-high { background-color: #e74c3c; color: white; }
        .risk-medium { background-color: #f39c12; color: white; }
        .risk-low { background-color: #27ae60; color: white; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #34495e; color: white; }
        .risk-cell { padding: 8px; border-radius: 4px; text-align: center; font-weight: bold; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Daily Risk Report</h1>
        <p>{{ summary.date }}</p>
    </div>
    
    <div class="summary">
        <h2>Summary</h2>
        <p><strong>Total Traders:</strong> {{ summary.total_traders }}</p>
        <p><strong>High Risk:</strong> {{ summary.high_risk_count }} | 
           <strong>Medium Risk:</strong> {{ summary.medium_risk_count }} | 
           <strong>Low Risk:</strong> {{ summary.low_risk_count }}</p>
        <p><strong>Average Risk Score:</strong> {{ "%.1f%%" | format(summary.average_risk * 100) }}</p>
        <p><strong>Total Recent P&L (5d):</strong> ${{ "{:,.2f}".format(summary.total_recent_pnl) }}</p>
    </div>
    
    {% if high_risk_traders %}
    <h2 style="color: #e74c3c;">ðŸš¨ High Risk Traders</h2>
    <table>
        <tr>
            <th>Trader</th>
            <th>Risk Score</th>
            <th>Recent P&L (5d)</th>
            <th>Recent Performance (3d)</th>
            <th>Confidence</th>
        </tr>
        {% for trader in high_risk_traders %}
        <tr>
            <td>{{ trader.trader_name }}</td>
            <td><span class="risk-cell risk-high">{{ "%.1f%%" | format(trader.risk_probability * 100) }}</span></td>
            <td>${{ "{:,.2f}".format(trader.recent_pnl) }}</td>
            <td>${{ "{:,.2f}".format(trader.recent_performance) }}</td>
            <td>{{ trader.confidence }}</td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}
    
    <h2>All Traders Risk Assessment</h2>
    <table>
        <tr>
            <th>Trader</th>
            <th>Risk Level</th>
            <th>Risk Score</th>
            <th>Recent P&L (5d)</th>
            <th>Recent Performance (3d)</th>
            <th>Confidence</th>
        </tr>
        {% for trader in predictions %}
        <tr>
            <td>{{ trader.trader_name }}</td>
            <td>
                <span class="risk-cell risk-{{ trader.risk_level.lower() }}">
                    {{ trader.risk_level }}
                </span>
            </td>
            <td>{{ "%.1f%%" | format(trader.risk_probability * 100) }}</td>
            <td>${{ "{:,.2f}".format(trader.recent_pnl) }}</td>
            <td>${{ "{:,.2f}".format(trader.recent_performance) }}</td>
            <td>{{ trader.confidence }}</td>
        </tr>
        {% endfor %}
    </table>
    
    <div style="margin-top: 30px; font-size: 12px; color: #7f8c8d;">
        <p><strong>Risk Score:</strong> Probability that trader will have negative P&L tomorrow</p>
        <p><strong>Confidence:</strong> High = Personal model available, Medium = Global model only</p>
        <p><strong>Generated:</strong> {{ summary.date }} by Risk Management System</p>
    </div>
</body>
</html>